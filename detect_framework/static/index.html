<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Application Discoverer</title>


</head>

<body style="font-family: 'Helvetica', 'Arial', sans-serif;">
    
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <h2>Application Discoverer</h2>

    <div>
        <p>Select a scan result:</p>
        <div id="content"></div>
        <p>Scan results are located in scans subfloder.</p>
        <p>They must be generated by detect_framework with option --detail.</p>
    </div>

</body>
<script>
$(function() {

	$.ajax({
        url : '/api/scans',
        success : function(res) 
        {
        	console.log(res);
            // clear the content section
            var content = document.getElementById("content");
            while (content.firstChild) {
                content.removeChild(content.firstChild);
            }

            var list = document.createElement("ul");
            content.appendChild(list);

            
            res['scans'].forEach(function(value) {
                
                var element = document.createElement("li");
                list.appendChild(element);
            	
                
                
                {
                	
                    text = document.createTextNode(value);
                    element.appendChild(text);
                	
                }

                var sub_list = document.createElement("ul");
                element.appendChild(sub_list);

                
                {                
                    var explore = document.createElement("li");
                    sub_list.appendChild(explore);
                    
                    var link = document.createElement("a");
                    
                    var url = location.protocol+'//'+location.host + '/static/discovery.html' + '#' + value
                    
                    link.setAttribute('href', url);
                    explore.appendChild(link);
                    
                    text = document.createTextNode('classic discovery');
                    link.appendChild(text);
                }                
                
                {                
	                var explore = document.createElement("li");
	                sub_list.appendChild(explore);
	                
	                var link = document.createElement("a");
	                
	                var url = location.protocol+'//'+location.host + '/static/discover.html' + '#' + value
	                
	                link.setAttribute('href', url);
	                explore.appendChild(link);
	                
	                text = document.createTextNode('explore content');
	                link.appendChild(text);
                }                
                
            });
        	
        },
        error : function(jqXHR, textStatus, errorThrown) 
        {
        	// clear the content section
            var content = document.getElementById("content");
            while (content.firstChild) {
                content.removeChild(content.firstChild);
            }
            // display 'error...'
            
            var loading = document.createElement("p");
            content.appendChild(loading);
            text = document.createTextNode(errorThrown);
            loading.appendChild(text);
        }
	});	
    
    
}); // ready
</script>
</html>
